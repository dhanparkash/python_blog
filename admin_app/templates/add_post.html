{% extends "admin_base.html" %}
{% block content %}
<h2>Add New Blog Post</h2>
<form method="POST" enctype="multipart/form-data">
    <label>Title:</label><br>
    <input type="text" name="title" required><br><br>

    <label>Slug (unique, e.g., my-first-post):</label><br>
    <input type="text" name="slug" required><br><br>

    <label>Thumbnail Image:</label><br>

     <img id="preview" style="max-width:200px; display:none; margin-bottom:10px;">
      <input type="file" name="thumbnail" id="thumbnail" accept="image/*"><br><br>

    <label>Content:</label><br>
    <textarea name="content" id="editor" rows="10" required></textarea><br><br>

    <button type="submit">Add Post</button>
</form>

<!-- Flash messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="alert alert-{{ category }}">{{ message }}</div>
    {% endfor %}
  {% endif %}
{% endwith %}

<!-- Optional: Quill editor -->
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>


<script>
document.getElementById('thumbnail').addEventListener('change', function (e) {
    const file = e.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function (e) {
        const img = document.getElementById('preview');
        img.src = e.target.result;
        img.style.display = 'block';
    };
    reader.readAsDataURL(file);
});
</script>
<script>
const quill = new Quill('#editor', {
    theme: 'snow',
    modules: { toolbar: [['bold','italic'], ['link','image']] }
});
document.querySelector('form').onsubmit = function() {
    document.querySelector('textarea[name=content]').value = quill.root.innerHTML;
};
</script>

{% endblock %}
